{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block title %}Settings{% endblock %}

{% block content %}
<div class="container" style="padding-top: 6rem; padding-left: 5rem; padding-right: 5rem; ">
    <h1 style="padding-top: 1rem; padding-bottom: 1rem;">Settings</h1>
    <p></p>
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <h2>Account</h2>
        {{ profile_settings | crispy }}
        <h2>General</h2>
        {{ site_settings | crispy }}
        <h2>osu! Integration</h2>
        <a href="{{ osu_oauth_url }}" class="btn btn-ayaka"><i class="mdi mdi-login" aria-hidden="true" style="font-size: 14px"></i> Authenticate with osu!</a>
        {% if oauth_token %}
        <p>Token expires in {{ oauth_token.expires_in }} seconds</p>
        {% else %}
        <p>Not authenticated</p>
        {% endif %}
        <p></p>
        <h2>Theme</h2>
        {{ colour_form | crispy }}
        <button class="btn btn-ayaka" type="submit">Submit</button>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
    let colorPrimaryPicker = document.getElementById('id_color_primary');
    let colorAccentPicker = document.getElementById('id_color_accent');
    let colorBackgroundPicker = document.getElementById('id_color_background');
    let maskOpacityInput = document.getElementById('id_mask_opacity');

    colorPrimaryPicker.addEventListener('change', function() {
        document.body.style.setProperty('--color-primary', colorPrimaryPicker.value);
    });
    colorAccentPicker.addEventListener('change', function() {
        document.body.style.setProperty('--color-accent', colorAccentPicker.value);
    });
    colorBackgroundPicker.addEventListener('change', function() {
        document.body.style.setProperty('--color-background', colorBackgroundPicker.value);
    });
    maskOpacityInput.addEventListener('change', function() {
        document.body.style.setProperty('--mask-opacity', maskOpacityInput.value);
    });
</script>
{% endblock %}
